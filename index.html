<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ve»ôti bune</title>
  <meta name="description" content="Rom√¢nia (RO) + Global (EN). Ve»ôti curate, actualizate automat." />

  <style>
    :root{
      --bg:#0b0b0f;
      --panel:#12121a;
      --panel2:#171724;
      --text:#f2f2f7;
      --muted:#b7b7c7;
      --muted2:#8b8ba1;
      --border:rgba(255,255,255,.10);
      --border2:rgba(255,255,255,.14);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --r:18px;
      --r2:14px;
      --max: 1180px;
      --btn:#1b1b2a;
      --btn2:#23233a;
      --link:#9fd3ff;
      --ok:#2be27a;
      --chip:#ffffff12;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 600px at 20% 0%, rgba(90,60,255,.18), transparent 60%),
        radial-gradient(900px 500px at 90% 15%, rgba(0,255,200,.10), transparent 55%),
        var(--bg);
      color:var(--text);
      line-height:1.35;
    }
    a{ color:inherit; text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .wrap{ max-width: var(--max); margin:0 auto; padding: 18px 14px 60px; }

    header{
      display:flex;
      gap:14px;
      align-items:flex-end;
      justify-content:space-between;
      padding: 10px 6px 14px;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .brand h1{
      margin:0;
      font-size: 26px;
      letter-spacing:.2px;
    }
    .brand .sub{
      color:var(--muted);
      font-size: 14px;
    }
    .pillrow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      justify-content:flex-end;
      align-items:center;
    }
    .pill{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color:var(--muted);
      padding:8px 10px;
      border-radius: 999px;
      font-size: 12px;
      display:flex;
      gap:8px;
      align-items:center;
      user-select:none;
    }
    .pill b{ color:var(--text); font-weight:700; }
    .pill a{ color: var(--link); text-decoration:underline; }

    /* ===== Top 3 photos ===== */
    .grid3{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin: 6px 0 14px;
    }
    .card{
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;

      display:flex;
      flex-direction:column;
      min-height: 260px;
    }
    .photo{
      position:relative;
      aspect-ratio: 16/10;
      background:#111;
      flex: 0 0 auto;
    }
    .photo img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      filter:saturate(1.05) contrast(1.05);
    }
    .tag{
      position:absolute;
      left:10px;
      top:10px;
      background: rgba(0,0,0,.45);
      border:1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(8px);
      color:#fff;
      padding:6px 10px;
      border-radius:999px;
      font-size: 12px;
      display:flex;
      gap:8px;
      align-items:center;
      z-index: 2;
    }
    .tag .dot{
      width:8px;
      height:8px;
      border-radius:999px;
      background: var(--ok);
      box-shadow: 0 0 0 3px rgba(43,226,122,.18);
    }
    .body{
      padding: 12px 12px 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
      flex: 1 1 auto;
      min-height: 86px;
    }
    .title{
      font-size: 14px;
      font-weight: 800;
      margin:0;
      line-height:1.25;

      display:-webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }
    .small{
      margin:0;
      color:var(--muted);
      font-size: 12px;
      line-height:1.25;

      display:-webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }

    /* ===== Joke + Satire ===== */
    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin: 10px 0 18px;
    }
    .mini{
      padding: 14px 14px 14px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border: 1px solid var(--border);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      min-height: 160px;
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }
    .mini h2{
      margin:0 0 8px;
      font-size: 16px;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .mini h2 span{
      font-size:12px;
      color:var(--muted);
      font-weight:800;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      padding: 4px 8px;
      border-radius:999px;
    }
    .mini .txt{
      margin:0;
      color:var(--text);
      font-size: 14px;
      line-height: 1.5;
    }
    .mini .src{
      margin-top:auto;
      font-size: 12px;
      color:var(--muted);
    }
    .mini .src a{ color: var(--link); text-decoration: underline; }

    /* ===== Controls ===== */
    .controls{
      display:flex;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      align-items:center;
      margin: 10px 0 10px;
    }
    .btnrow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }
    button{
      border:1px solid var(--border);
      background: var(--btn);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 13px;
      cursor:pointer;
      user-select:none;
    }
    button:hover{ background: var(--btn2); }
    button.active{
      border-color: rgba(159,211,255,.55);
      box-shadow: 0 0 0 4px rgba(159,211,255,.12);
      background: rgba(159,211,255,.10);
    }
    .status{
      color: var(--muted);
      font-size: 12px;
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .status code{
      color: var(--text);
      background: rgba(255,255,255,.06);
      border:1px solid var(--border);
      padding: 3px 6px;
      border-radius: 8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
    }

    /* ===== Sections / news cards ===== */
    .sections{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 10px;
    }
    .section{
      border: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
      border-radius: var(--r);
      overflow:hidden;
      box-shadow: var(--shadow);
    }
    .sectionhead{
      padding: 12px 14px;
      border-bottom: 1px solid var(--border);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      flex-wrap:wrap;
      background: rgba(255,255,255,.03);
    }
    .sectionhead h3{
      margin:0;
      font-size: 15px;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .badge{
      font-size: 11px;
      color: var(--muted);
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      padding: 4px 8px;
      border-radius:999px;
      font-weight:800;
    }
    .items{
      display:grid;
      grid-template-columns: 1fr;
    }
    .item{
      display:grid;
      grid-template-columns: 160px 1fr;
      gap: 12px;
      padding: 12px 14px;
      border-top: 1px solid rgba(255,255,255,.06);
      align-items:start;
    }
    .item:first-child{ border-top:0; }
    .thumb{
      width:160px;
      aspect-ratio: 16/10;
      border-radius: 14px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
      background: #0f0f16;
    }
    .thumb img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      filter: saturate(1.03) contrast(1.03);
    }
    .meta{
      display:flex;
      flex-direction:column;
      gap:8px;
      min-width: 0;
    }
    .meta .t{
      margin:0;
      font-weight: 900;
      font-size: 15px;
      letter-spacing:.1px;
      line-height: 1.25;
    }
    .meta .t a{ text-decoration:none; }
    .meta .t a:hover{ text-decoration:underline; }
    .meta .s{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.5;
      overflow-wrap:anywhere;
      display:-webkit-box;
      -webkit-line-clamp: 4;
      -webkit-box-orient: vertical;
      overflow:hidden;
    }
    .row{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      color: var(--muted2);
      font-size: 12px;
    }
    .k{
      padding: 4px 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: var(--chip);
      color: var(--muted);
      font-weight:900;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing:.6px;
    }
    .k.ro{ border-color: rgba(159,211,255,.35); background: rgba(159,211,255,.08); }
    .k.en{ border-color: rgba(255,204,102,.35); background: rgba(255,204,102,.10); }

    .dot2{
      width:6px;
      height:6px;
      border-radius:999px;
      background: rgba(255,255,255,.28);
      display:inline-block;
    }

    .empty{
      padding: 14px;
      color: var(--muted);
    }

    footer{
      margin-top: 26px;
      color: var(--muted2);
      font-size: 12px;
      text-align:center;
      padding: 18px 0 0;
    }
    footer a{ color: var(--link); }

    @media (max-width: 920px){
      .grid3{ grid-template-columns: 1fr; }
      .grid2{ grid-template-columns: 1fr; }
      .item{ grid-template-columns: 1fr; }
      .thumb{ width:100%; }
      header{ align-items:flex-start; flex-direction:column; }
      .pillrow{ justify-content:flex-start; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <h1>Ve»ôti bune</h1>
        <div class="sub">Rom√¢nia (RO) + Global (EN). Actualizat automat.</div>
      </div>
      <div class="pillrow">
        <div class="pill"><b>Mod</b> Mix / RO / EN</div>
        <div class="pill"><b>Date</b> <a href="./data/news.json" target="_blank" rel="noopener">news.json</a></div>
        <div class="pill"><b>Tip</b> hard refresh <code>Cmd+Shift+R</code></div>
      </div>
    </header>

    <!-- TOP PHOTOS (3 categories) -->
    <div class="grid3" id="topPhotos">
      <div class="card">
        <div class="photo">
          <img alt="Space" referrerpolicy="no-referrer" loading="lazy"
               src="https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?auto=format&fit=crop&w=1200&q=60" />
          <div class="tag"><span class="dot"></span> Space</div>
        </div>
        <div class="body">
          <p class="title">Space</p>
          <p class="small">Astronomie, cosmos, imagini lini»ôtitoare.</p>
        </div>
      </div>

      <div class="card">
        <div class="photo">
          <img alt="Animals" referrerpolicy="no-referrer" loading="lazy"
               src="https://images.unsplash.com/photo-1504203700686-0be9c8fdf38a?auto=format&fit=crop&w=1200&q=60" />
          <div class="tag"><span class="dot"></span> Animals</div>
        </div>
        <div class="body">
          <p class="title">Animals</p>
          <p class="small">Doar vibe bun. üêæ</p>
        </div>
      </div>

      <div class="card">
        <div class="photo">
          <img alt="Landscape" referrerpolicy="no-referrer" loading="lazy"
               src="https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1200&q=60" />
          <div class="tag"><span class="dot"></span> Landscape</div>
        </div>
        <div class="body">
          <p class="title">Landscape</p>
          <p class="small">NaturƒÉ, mun»õi, reset mental.</p>
        </div>
      </div>
    </div>

    <!-- JOKE + SATIRE -->
    <div class="grid2">
      <div class="mini">
        <h2>Gluma zilei <span>RO</span></h2>
        <p class="txt" id="jokeText">Se √ÆncarcƒÉ‚Ä¶</p>
        <p class="src">SursƒÉ: <a href="#" id="jokeSrc" target="_blank" rel="noopener">link</a></p>
      </div>

      <div class="mini">
        <h2>Satira zilei <span>RO</span></h2>
        <p class="txt" id="satireText">Se √ÆncarcƒÉ‚Ä¶</p>
        <p class="src">SursƒÉ: <a href="#" id="satireSrc" target="_blank" rel="noopener">link</a></p>
      </div>
    </div>

    <!-- CONTROLS -->
    <div class="controls">
      <div class="btnrow">
        <button id="btnMix" class="active" type="button">‚ú® Mix</button>
        <button id="btnRO" type="button">üá∑üá¥ RO</button>
        <button id="btnEN" type="button">üåç EN</button>
      </div>
      <div class="status">
        <span id="statusText">Se √ÆncarcƒÉ »ôtirile‚Ä¶</span>
        <span class="dot2"></span>
        <span>Ultima actualizare: <code id="generatedUtc">‚Äî</code></span>
      </div>
    </div>

    <!-- FEED -->
    <div class="sections" id="sections"></div>

    <footer>
      DacƒÉ vezi versiune veche: <b>Cmd+Shift+R</b> / <b>Ctrl+F5</b>.
    </footer>
  </div>

  <script>
    const $ = (sel) => document.querySelector(sel);

    function esc(s){
      return (s ?? "").replace(/[&<>"']/g, m => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[m]));
    }
    function toDate(iso){
      try {
        const d = new Date(iso);
        return d.toLocaleString("ro-RO", { year:"numeric", month:"short", day:"2-digit", hour:"2-digit", minute:"2-digit" });
      } catch { return iso || ""; }
    }
    function hostOf(url){
      try { return new URL(url).hostname.replace(/^www\./,''); }
      catch { return ""; }
    }

    // Banc + satirƒÉ (deterministic pe zi)
    const jokes = [
      { t: "‚Äî De ce QA-ul nu merge la petreceri? ‚Äî Pentru cƒÉ mereu gƒÉse»ôte bug-uri √Æn atmosferƒÉ.", u: "https://en.wikipedia.org/wiki/Software_testing" },
      { t: "DacƒÉ totul pare ok‚Ä¶ √ÆnseamnƒÉ cƒÉ n-ai testat suficient.", u: "https://en.wikipedia.org/wiki/Quality_assurance" },
      { t: "Veste bunƒÉ: am reparat bug-ul. Veste »ôi mai bunƒÉ: am gƒÉsit √ÆncƒÉ 5!", u: "https://en.wikipedia.org/wiki/Debugging" },
      { t: "Am √Æncercat sƒÉ fiu pozitiv. A ie»ôit un test case cu 0 pa»ôi »ôi 3 a»ôteptƒÉri.", u: "https://en.wikipedia.org/wiki/Test_case" },
    ];
    const satire = [
      { t: "Breaking: Rom√¢nia intrƒÉ √Æn topul mondial la optimism‚Ä¶ dupƒÉ ce a dezinstalat notificƒÉrile.", u: "https://en.wikipedia.org/wiki/Satire" },
      { t: "S-a descoperit o metodƒÉ nouƒÉ de productivitate: √Ænchizi 3 tab-uri »ôi te sim»õi ca »ôi cum ai terminat proiectul.", u: "https://en.wikipedia.org/wiki/Procrastination" },
      { t: "Un studiu aratƒÉ cƒÉ 9 din 10 oameni preferƒÉ ve»ôtile bune. Al 10-lea preferƒÉ sƒÉ se pl√¢ngƒÉ cƒÉ sunt prea pu»õine.", u: "https://en.wikipedia.org/wiki/Negativity_bias" },
      { t: "Economi»ôtii confirmƒÉ: dacƒÉ nu verifici contul, cheltuielile scad cu 100%.", u: "https://en.wikipedia.org/wiki/Behavioral_economics" }
    ];
    function pickDaily(arr){
      const d = new Date();
      const key = Number(`${d.getFullYear()}${String(d.getMonth()+1).padStart(2,'0')}${String(d.getDate()).padStart(2,'0')}`);
      return arr[key % arr.length];
    }
    const j = pickDaily(jokes);
    $("#jokeText").textContent = j.t;
    $("#jokeSrc").href = j.u;

    const s = pickDaily(satire);
    $("#satireText").textContent = s.t;
    $("#satireSrc").href = s.u;

    // ===== News rendering =====
    const state = { mode: "mix", sections: {} };

    function isRO(it){ return (it.kind === "ro") || (it.section === "romania"); }
    function isEN(it){ return !isRO(it); }

    function sectionLabel(key){
      const map = {
        romania: "üá∑üá¥ Rom√¢nia",
        medical: "ü©∫ Medical",
        science: "üî¨ »òtiin»õƒÉ",
        environment: "üå± Mediu",
        tech: "üíª Tech",
        business: "üíº Business",
        culture: "üé≠ CulturƒÉ",
        sports: "‚öΩ Sport",
        funny: "üòÑ Fun"
      };
      return map[key] || (key.charAt(0).toUpperCase() + key.slice(1));
    }

    // Fallback images per section (so left side is ALWAYS filled)
    const FALLBACK_BY_SECTION = {
      romania:     "https://images.unsplash.com/photo-1528909514045-2fa4ac7a08ba?auto=format&fit=crop&w=900&q=60",
      medical:     "https://images.unsplash.com/photo-1582719478185-2bbf4f2b0b1b?auto=format&fit=crop&w=900&q=60",
      science:     "https://images.unsplash.com/photo-1532187863486-abf9dbad1b69?auto=format&fit=crop&w=900&q=60",
      environment: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=900&q=60",
      tech:        "https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&w=900&q=60",
      business:    "https://images.unsplash.com/photo-1520607162513-77705c0f0d4a?auto=format&fit=crop&w=900&q=60",
      culture:     "https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=900&q=60",
      sports:      "https://images.unsplash.com/photo-1521412644187-c49fa049e84d?auto=format&fit=crop&w=900&q=60",
      funny:       "https://images.unsplash.com/photo-1545239351-1141bd82e8a6?auto=format&fit=crop&w=900&q=60",
      other:       "https://images.unsplash.com/photo-1522202176988-66273c2fd55f?auto=format&fit=crop&w=900&q=60",
    };

    function pickImage(it){
      // 1) if generator provides it.image -> use it
      if (it.image && typeof it.image === "string" && it.image.startsWith("http")) return it.image;

      // 2) fallback by section
      const sec = (it.section || "other").toLowerCase();
      return FALLBACK_BY_SECTION[sec] || FALLBACK_BY_SECTION.other;
    }

    function normalizeSections(raw){
      const secs = raw.sections || {};
      const out = {};
      for (const [k, arr] of Object.entries(secs)){
        out[k] = (arr || []).map(x => ({
          section: x.section || k,
          kind: x.kind || (k === "romania" ? "ro" : "global"),
          source: x.source || hostOf(x.link),
          title: x.title || "",
          summary: x.summary || "",
          link: x.link || "#",
          published_utc: x.published_utc || "",
          image: x.image || null
        })).sort((a,b)=> (b.published_utc||"").localeCompare(a.published_utc||""));
      }
      return out;
    }

    function filterByMode(all, mode){
      const filtered = {};
      for (const [k, arr] of Object.entries(all)){
        let a = arr;
        if (mode === "ro") a = arr.filter(isRO);
        if (mode === "en") a = arr.filter(isEN);
        if (a.length) filtered[k] = a;
      }
      return filtered;
    }

    function render(sections){
      const root = $("#sections");
      root.innerHTML = "";

      const keys = Object.keys(sections);
      if (!keys.length){
        root.innerHTML = `<div class="section"><div class="empty">Nu sunt »ôtiri pentru filtrul ales.</div></div>`;
        return;
      }

      for (const k of keys){
        const arr = sections[k];

        const box = document.createElement("div");
        box.className = "section";
        box.innerHTML = `
          <div class="sectionhead">
            <h3>${esc(sectionLabel(k))}</h3>
            <span class="badge">${arr.length} articole</span>
          </div>
          <div class="items"></div>
        `;
        const itemsEl = box.querySelector(".items");

        for (const it of arr){
          const kindText = isRO(it) ? "RO" : "EN";
          const kindClass = isRO(it) ? "ro" : "en";
          const img = pickImage(it);

          const item = document.createElement("div");
          item.className = "item";
          item.innerHTML = `
            <div class="thumb">
              <img loading="lazy" referrerpolicy="no-referrer" alt="" src="${esc(img)}" />
            </div>
            <div class="meta">
              <p class="t"><a target="_blank" rel="noopener" href="${esc(it.link)}">${esc(it.title)}</a></p>
              <p class="s">${esc(it.summary)}</p>
              <div class="row">
                <span class="k ${kindClass}">${kindText}</span>
                <span class="dot2"></span>
                <span>${esc(it.source || hostOf(it.link))}</span>
                <span class="dot2"></span>
                <span>${esc(toDate(it.published_utc))}</span>
              </div>
            </div>
          `;
          itemsEl.appendChild(item);
        }

        root.appendChild(box);
      }
    }

    function setMode(mode){
      state.mode = mode;
      $("#btnMix").classList.toggle("active", mode === "mix");
      $("#btnRO").classList.toggle("active", mode === "ro");
      $("#btnEN").classList.toggle("active", mode === "en");

      const filtered = filterByMode(state.sections, mode);
      render(filtered);

      const count = Object.values(filtered).reduce((acc, a) => acc + a.length, 0);
      $("#statusText").textContent = `Afi»ôez: ${count} articole ‚Ä¢ Filtru: ${mode.toUpperCase()}`;
    }

    async function load(){
      try{
        $("#statusText").textContent = "Se √ÆncarcƒÉ »ôtirile‚Ä¶";
        const res = await fetch("./data/news.json?t=" + Date.now(), { cache: "no-store" });
        if (!res.ok) throw new Error("Nu pot √ÆncƒÉrca ./data/news.json");
        const raw = await res.json();
        $("#generatedUtc").textContent = raw.generated_utc ? raw.generated_utc : "‚Äî";
        state.sections = normalizeSections(raw);
        setMode("mix");
      }catch(e){
        console.error(e);
        $("#statusText").textContent = "Eroare la √ÆncƒÉrcarea »ôtirilor.";
        $("#sections").innerHTML = `<div class="section"><div class="empty">Nu pot √ÆncƒÉrca <code>data/news.json</code>.</div></div>`;
      }
    }

    $("#btnMix").addEventListener("click", () => setMode("mix"));
    $("#btnRO").addEventListener("click", () => setMode("ro"));
    $("#btnEN").addEventListener("click", () => setMode("en"));

    load();
  </script>
</body>
</html>
