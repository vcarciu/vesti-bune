<!doctype html>
<html lang="ro">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ve»ôti bune</title>

<style>
:root{
  --bg:#0b0b0f;
  --panel:#14141d;
  --text:#f2f2f7;
  --muted:#b7b7c7;
  --muted2:#8b8ba1;
  --border:rgba(255,255,255,.10);
  --shadow:0 10px 30px rgba(0,0,0,.35);
  --r:18px;
  --max:1180px;
  --btn:#1b1b2a;
  --btn2:#23233a;
  --link:#9fd3ff;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background: radial-gradient(1200px 600px at 20% 0%, rgba(90,60,255,.18), transparent 60%),
              radial-gradient(900px 500px at 90% 15%, rgba(0,255,200,.10), transparent 55%),
              var(--bg);
  color:var(--text);
}
a{color:inherit}
.wrap{max-width:var(--max);margin:0 auto;padding:20px}

/* HEADER */
header{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:14px;
  margin-bottom:18px;
}
h1{margin:0;font-size:26px}
.sub{color:var(--muted);font-size:14px}
.metaTop{color:var(--muted2);font-size:12px}
.metaTop a{color:var(--link)}

/* TOP 3 CARDS */
.grid3{
  display:grid;
  grid-template-columns:repeat(3, minmax(0, 1fr));
  gap:14px;
  margin-bottom:18px;
}
.card{
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  border:1px solid var(--border);
  border-radius:var(--r);
  overflow:hidden;
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  min-height:280px;
}
.photo{
  height:190px;
  overflow:hidden;
  background:#111;
  flex:0 0 auto;
}
.photo img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
  filter:saturate(1.05) contrast(1.05);
}
.body{
  padding:12px;
  min-height:88px;
}
.title{
  margin:0;
  font-weight:800;
  font-size:14px;
  line-height:1.25;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
.small{
  margin:6px 0 0;
  font-size:12px;
  color:var(--muted);
  line-height:1.25;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}

/* JOKE + SATIRE */
.grid2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  margin-bottom:18px;
}
.mini{
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  border:1px solid var(--border);
  border-radius:var(--r);
  padding:14px;
  box-shadow:var(--shadow);
  min-height:150px;
  display:flex;
  flex-direction:column;
}
.mini h2{margin:0 0 10px;font-size:15px}
.mini p{margin:0; color:var(--text); line-height:1.5}
.mini .foot{margin-top:auto;color:var(--muted2);font-size:12px}
.mini .foot a{color:var(--link)}

/* CONTROLS */
.controls{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  flex-wrap:wrap;
  margin-bottom:14px;
}
.btns{display:flex;gap:8px;flex-wrap:wrap}
button{
  border:1px solid var(--border);
  background:var(--btn);
  color:var(--text);
  padding:8px 14px;
  border-radius:999px;
  cursor:pointer;
}
button:hover{background:var(--btn2)}
button.active{
  background:rgba(159,211,255,.12);
  border-color:rgba(159,211,255,.60);
  box-shadow:0 0 0 4px rgba(159,211,255,.10);
}
.status{color:var(--muted);font-size:12px}
.status code{
  color:var(--text);
  background: rgba(255,255,255,.06);
  border:1px solid var(--border);
  padding:3px 6px;
  border-radius:8px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size:11px;
}

/* NEWS */
.section{
  background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
  border:1px solid var(--border);
  border-radius:var(--r);
  margin-bottom:14px;
  box-shadow:var(--shadow);
  overflow:hidden;
}
.sectionhead{
  padding:12px 14px;
  border-bottom:1px solid var(--border);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  flex-wrap:wrap;
  font-weight:800;
}
.badge{
  font-size:11px;
  color:var(--muted);
  border:1px solid var(--border);
  background:rgba(255,255,255,.04);
  padding:4px 8px;
  border-radius:999px;
}
.item{
  display:grid;
  grid-template-columns:160px 1fr;
  gap:12px;
  padding:12px 14px;
  border-top:1px solid rgba(255,255,255,.08);
}
.item:first-child{border-top:0}
.thumb{
  height:100px;
  overflow:hidden;
  border-radius:12px;
  background:#0f0f16;
  border:1px solid rgba(255,255,255,.10);
}
.thumb img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}
.meta .t{
  margin:0;
  font-weight:900;
  line-height:1.25;
}
.meta .t a{text-decoration:none}
.meta .t a:hover{text-decoration:underline}
.meta .s{
  margin:6px 0;
  font-size:13px;
  color:var(--muted);
  line-height:1.5;
  display:-webkit-box;
  -webkit-line-clamp:4;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
.meta .row{
  font-size:12px;
  color:var(--muted2);
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}
.k{
  padding:3px 8px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(255,255,255,.04);
  font-weight:900;
  font-size:11px;
  letter-spacing:.6px;
  text-transform:uppercase;
  color:var(--muted);
}
.k.ro{border-color:rgba(159,211,255,.35); background:rgba(159,211,255,.08)}
.k.en{border-color:rgba(255,204,102,.35); background:rgba(255,204,102,.10)}
.empty{
  padding:14px;
  color:var(--muted);
  font-size:13px;
}

@media(max-width:900px){
  header{flex-direction:column;align-items:flex-start}
  .grid3{grid-template-columns:1fr}
  .grid2{grid-template-columns:1fr}
  .item{grid-template-columns:1fr}
  .thumb{height:200px}
}
</style>
</head>

<body>
<div class="wrap">

<header>
  <div>
    <h1>Ve»ôti bune</h1>
    <div class="sub">Rom√¢nia (RO) + Global (EN)</div>
  </div>
  <div class="metaTop">
    Data: <a href="./data/news.json" target="_blank" rel="noopener">news.json</a>
    ‚Ä¢ Ultima actualizare: <code id="generatedUtc">‚Äî</code>
  </div>
</header>

<!-- TOP 3 (relevante, nu random) -->
<div class="grid3">
  <div class="card">
    <div class="photo">
      <img referrerpolicy="no-referrer" loading="lazy" alt="Space"
           src="https://images.unsplash.com/photo-1446776811953-b23d57bd21aa?auto=format&fit=crop&w=1400&q=70"/>
    </div>
    <div class="body">
      <p class="title">Space</p>
      <p class="small">Astronomie »ôi cosmos.</p>
    </div>
  </div>

  <div class="card">
    <div class="photo">
      <img referrerpolicy="no-referrer" loading="lazy" alt="Animals"
           src="https://images.unsplash.com/photo-1456926631375-92c8ce872def?auto=format&fit=crop&w=1400&q=70"/>
    </div>
    <div class="body">
      <p class="title">Animals</p>
      <p class="small">Doar vibe bun. üêæ</p>
    </div>
  </div>

  <div class="card">
    <div class="photo">
      <img referrerpolicy="no-referrer" loading="lazy" alt="Landscape"
           src="https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1400&q=70"/>
    </div>
    <div class="body">
      <p class="title">Landscape</p>
      <p class="small">NaturƒÉ »ôi reset mental.</p>
    </div>
  </div>
</div>

<!-- JOKE + SATIRE -->
<div class="grid2">
  <div class="mini">
    <h2>Gluma zilei</h2>
    <p id="jokeText">Se √ÆncarcƒÉ‚Ä¶</p>
    <div class="foot">SursƒÉ: <a id="jokeSrc" href="#" target="_blank" rel="noopener">link</a></div>
  </div>
  <div class="mini">
    <h2>Satira zilei</h2>
    <p id="satireText">Se √ÆncarcƒÉ‚Ä¶</p>
    <div class="foot">SursƒÉ: <a id="satireSrc" href="#" target="_blank" rel="noopener">link</a></div>
  </div>
</div>

<!-- CONTROLS -->
<div class="controls">
  <div class="btns">
    <button id="btnMix" class="active">Mix</button>
    <button id="btnRO">RO</button>
    <button id="btnEN">EN</button>
  </div>
  <div class="status" id="statusText">Se √ÆncarcƒÉ »ôtirile‚Ä¶</div>
</div>

<div id="sections"></div>

</div>

<script>
/* ===== Banc + SatirƒÉ ===== */
const jokes = [
  { t:"‚Äî De ce QA-ul nu merge la petreceri? ‚Äî Pentru cƒÉ mereu gƒÉse»ôte bug-uri √Æn atmosferƒÉ.", u:"https://en.wikipedia.org/wiki/Software_testing" },
  { t:"DacƒÉ totul pare ok‚Ä¶ √ÆnseamnƒÉ cƒÉ n-ai testat suficient.", u:"https://en.wikipedia.org/wiki/Quality_assurance" },
  { t:"Veste bunƒÉ: am reparat bug-ul. Veste »ôi mai bunƒÉ: am gƒÉsit √ÆncƒÉ 5!", u:"https://en.wikipedia.org/wiki/Debugging" },
];
const satire = [
  { t:"Breaking: Rom√¢nia intrƒÉ √Æn topul optimismului dupƒÉ dezinstalarea notificƒÉrilor.", u:"https://en.wikipedia.org/wiki/Satire" },
  { t:"NouƒÉ metodƒÉ de productivitate: √Ænchizi 3 tab-uri »ôi te sim»õi ca »ôi cum ai terminat proiectul.", u:"https://en.wikipedia.org/wiki/Procrastination" },
  { t:"9 din 10 oameni preferƒÉ ve»ôtile bune. Al 10-lea preferƒÉ sƒÉ se pl√¢ngƒÉ cƒÉ sunt prea pu»õine.", u:"https://en.wikipedia.org/wiki/Negativity_bias" },
];
function pickDaily(arr){
  const d = new Date();
  const key = Number(`${d.getFullYear()}${String(d.getMonth()+1).padStart(2,'0')}${String(d.getDate()).padStart(2,'0')}`);
  return arr[key % arr.length];
}
const j = pickDaily(jokes);
document.getElementById("jokeText").textContent = j.t;
document.getElementById("jokeSrc").href = j.u;
const s = pickDaily(satire);
document.getElementById("satireText").textContent = s.t;
document.getElementById("satireSrc").href = s.u;

/* ===== News UI ===== */
const SECTIONS_ORDER = ["romania","medical","science","environment"];
const SECTIONS_LABELS = {
  romania: "üá∑üá¥ Rom√¢nia",
  medical: "ü©∫ Medical",
  science: "üî¨ »òtiin»õƒÉ",
  environment: "üå± Mediu",
};

function esc(s){
  return (s ?? "").replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));
}
function hostOf(url){
  try { return new URL(url).hostname.replace(/^www\./,''); } catch { return ""; }
}
function isRO(it){ return (it.kind === "ro") || (it.section === "romania"); }
function isEN(it){ return !isRO(it); }

function seedForItem(it){
  const base = (it.link || it.title || "x").toString();
  let h = 0;
  for (let i = 0; i < base.length; i++) h = (h * 31 + base.charCodeAt(i)) >>> 0;
  return "vb-" + h.toString(16);
}
function pickImage(it){
  if (it.image && typeof it.image === "string" && it.image.startsWith("http")) return it.image;
  const seed = seedForItem(it);
  return `https://picsum.photos/seed/${seed}/900/600`;
}

let mode = "mix";
let rawSections = {};

function normalize(raw){
  const secs = raw.sections || {};
  const out = {};
  for (const [k, arr] of Object.entries(secs)){
    out[k] = (arr || []).map(x => ({
      section: x.section || k,
      kind: x.kind || (k === "romania" ? "ro" : "global"),
      source: x.source || hostOf(x.link),
      title: x.title || "",
      summary: x.summary || "",
      link: x.link || "#",
      published_utc: x.published_utc || "",
      image: x.image || null,
    }));
  }
  // asigurƒÉ sec»õiunile principale chiar dacƒÉ lipsesc din JSON
  for (const k of SECTIONS_ORDER){
    if (!out[k]) out[k] = [];
  }
  return out;
}

function buildMix(sections){
  // Mix real: une»ôte tot, sorteazƒÉ, apoi √Æmparte √Ænapoi pe sec»õiuni
  const all = [];
  for (const [k, arr] of Object.entries(sections)){
    for (const it of arr) all.push(it);
  }
  all.sort((a,b)=> (b.published_utc||"").localeCompare(a.published_utc||""));
  const by = {};
  for (const it of all){
    const k = it.section || (isRO(it) ? "romania" : "science");
    (by[k] ||= []).push(it);
  }
  for (const k of SECTIONS_ORDER){
    if (!by[k]) by[k] = [];
  }
  return by;
}

function applyMode(){
  const base = (mode === "mix") ? buildMix(rawSections) : rawSections;
  const filtered = {};
  for (const k of SECTIONS_ORDER){
    const arr = base[k] || [];
    let a = arr;
    if (mode === "ro") a = arr.filter(isRO);
    if (mode === "en") a = arr.filter(isEN);
    filtered[k] = a;
  }
  render(filtered);
}

function render(sections){
  const root = document.getElementById("sections");
  root.innerHTML = "";

  let total = 0;

  for (const k of SECTIONS_ORDER){
    const arr = sections[k] || [];
    total += arr.length;

    const box = document.createElement("div");
    box.className = "section";
    box.innerHTML = `
      <div class="sectionhead">
        <div>${esc(SECTIONS_LABELS[k] || k)}</div>
        <div class="badge">${arr.length} articole</div>
      </div>
      <div class="items"></div>
    `;
    const itemsEl = box.querySelector(".items");

    if (!arr.length){
      const empty = document.createElement("div");
      empty.className = "empty";
      empty.textContent = "0 articole (generatorul nu a populat aceastƒÉ sec»õiune).";
      itemsEl.appendChild(empty);
    } else {
      for (const it of arr){
        const kindText = isRO(it) ? "RO" : "EN";
        const kindClass = isRO(it) ? "ro" : "en";
        const img = pickImage(it);

        const row = document.createElement("div");
        row.className = "item";
        row.innerHTML = `
          <div class="thumb">
            <img loading="lazy" referrerpolicy="no-referrer" alt="" src="${esc(img)}"/>
          </div>
          <div class="meta">
            <p class="t"><a target="_blank" rel="noopener" href="${esc(it.link)}">${esc(it.title)}</a></p>
            <p class="s">${esc(it.summary)}</p>
            <div class="row">
              <span class="k ${kindClass}">${kindText}</span>
              <span>${esc(it.source || hostOf(it.link))}</span>
            </div>
          </div>
        `;
        itemsEl.appendChild(row);
      }
    }

    root.appendChild(box);
  }

  document.getElementById("statusText").textContent =
    `Afi»ôez: ${total} articole ‚Ä¢ Filtru: ${mode.toUpperCase()}`;
}

function setMode(m){
  mode = m;
  document.getElementById("btnMix").classList.toggle("active", mode==="mix");
  document.getElementById("btnRO").classList.toggle("active", mode==="ro");
  document.getElementById("btnEN").classList.toggle("active", mode==="en");
  applyMode();
}

document.getElementById("btnMix").onclick = () => setMode("mix");
document.getElementById("btnRO").onclick  = () => setMode("ro");
document.getElementById("btnEN").onclick  = () => setMode("en");

async function load(){
  try{
    const res = await fetch("./data/news.json?t=" + Date.now(), { cache: "no-store" });
    const raw = await res.json();
    document.getElementById("generatedUtc").textContent = raw.generated_utc || "‚Äî";
    rawSections = normalize(raw);
    setMode("mix");
  }catch(e){
    document.getElementById("statusText").textContent = "Eroare: nu pot √ÆncƒÉrca data/news.json";
    console.error(e);
  }
}
load();
</script>

</body>
</html>
