<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Ve»ôti bune</title>
  <meta name="description" content="Ve»ôti bune: »ôtiri pozitive, curate, din surse serioase. Rom√¢nia »ôi global, pe sec»õiuni." />

  <link rel="canonical" href="https://vcarciu.github.io/vesti-bune/" />
  <link rel="icon" href="/vesti-bune/favicon.svg" type="image/svg+xml" />

  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Ve»ôti bune" />
  <meta property="og:title" content="Ve»ôti bune" />
  <meta property="og:description" content="»òtiri pozitive, curate, din surse serioase. Rom√¢nia + global, pe sec»õiuni." />
  <meta property="og:url" content="https://vcarciu.github.io/vesti-bune/" />
  <meta property="og:image" content="https://vcarciu.github.io/vesti-bune/og.jpg" />
  <meta property="og:image:secure_url" content="https://vcarciu.github.io/vesti-bune/og.jpg" />
  <meta property="og:image:type" content="image/jpeg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Ve»ôti bune" />
  <meta name="twitter:description" content="»òtiri pozitive, curate, din surse serioase." />
  <meta name="twitter:image" content="https://vcarciu.github.io/vesti-bune/og.jpg" />
</head>

<body style="
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  max-width: 900px;
  margin: 0 auto;
  padding: 20px;
  background: #fafafa;
  color: #111;
">

  <header style="display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px;">
    <div></div>
    <a href="/vesti-bune/about.html" style="color:#111; text-decoration:underline; font-size:13px;">
      Despre proiect
    </a>
  </header>

  <h1 style="font-size:44px; margin:10px 0;">Ve»ôti bune</h1>
  <p style="color:#444; margin:0 0 10px;">
    Curate. Pe sec»õiuni. Refresh automat la fiecare 60 de minute.
  </p>
  <p id="meta" style="color:#666; font-size:13px; margin:0 0 18px;"></p>

  <div id="top-blocks" style="
    display:grid;
    grid-template-columns: 1fr;
    gap:12px;
    margin-bottom:18px;
    align-items:stretch;
  "></div>

  <div id="sections"></div>

  <script>
    const SECTION_TITLES = {
      romania: "üá∑üá¥ Rom√¢nia",
      medical: "ü©∫ Descoperiri medicale",
      science: "üî¨ »òtiin»õƒÉ & Tech",
      environment: "üå± Mediu & Energie"
    };

    function el(tag, attrs = {}, text = "") {
      const n = document.createElement(tag);
      for (const [k, v] of Object.entries(attrs)) {
        if (k === "style") n.style.cssText = v;
        else n.setAttribute(k, v);
      }
      if (text) n.textContent = text;
      return n;
    }

    function cardBase(extra = "") {
      return `
        background:#fff;
        border:1px solid #e8e8e8;
        border-radius:14px;
        padding:16px;
        box-shadow:0 1px 8px rgba(0,0,0,0.04);
        ${extra}
      `;
    }

    function renderNewsItem(it) {
      const card = el("div", { style: cardBase() + " margin:12px 0;" });

      const h = el("h3", { style: "margin:0 0 8px;font-size:18px;line-height:1.25" });
      const a = el("a", {
        href: it.link,
        target: "_blank",
        rel: "noopener noreferrer",
        style: "color:#111;text-decoration:none"
      });

      const title = (it.kind === "global" && it.title_ro) ? it.title_ro : it.title;
      a.textContent = title;
      a.onmouseover = () => a.style.textDecoration = "underline";
      a.onmouseout = () => a.style.textDecoration = "none";
      h.appendChild(a);

      const summary = (it.kind === "global" && it.summary_ro) ? it.summary_ro : (it.summary || "");
      const p = el("p", { style: "margin:0 0 10px;color:#333;line-height:1.5" }, summary);

      const meta = el("div", { style: "font-size:12px;color:#777" });
      const d = new Date(it.published_utc);

      if (it.kind === "global") {
        meta.innerHTML =
          `üåç GLOBAL ‚Ä¢ Titlu & rezumat traduse ‚Ä¢ ${it.source} ‚Ä¢ ${d.toLocaleString("ro-RO")} ‚Ä¢ ` +
          `<a href="${it.link}" target="_blank" rel="noopener noreferrer" style="color:#555;text-decoration:underline">Original</a>`;
      } else {
        meta.textContent = `üá∑üá¥ RO ‚Ä¢ ${it.source} ‚Ä¢ ${d.toLocaleString("ro-RO")}`;
      }

      card.appendChild(h);
      if (summary) card.appendChild(p);
      card.appendChild(meta);

      return card;
    }

    function renderTopBlocks(sections) {
      const host = document.getElementById("top-blocks");
      host.innerHTML = "";

      function setCols() {
        host.style.gridTemplateColumns = (window.innerWidth >= 900) ? "1fr 1fr 1fr" : "1fr";
      }
      setCols();
      window.addEventListener("resize", setCols);

      const FIXED_H = "240px";

      // üì∏ Photos (1 Space + 1 Animals + 1 Landscapes)
      const photos = Array.isArray(sections.photos) ? sections.photos : [];
      const photoCard = el("div", { style: cardBase(`height:${FIXED_H}; overflow:hidden; display:flex; flex-direction:column;`) });
      photoCard.appendChild(el("div", { style:"font-size:13px;color:#666;margin-bottom:10px" }, "üì∏ Pozele zilei"));

      if (photos.length) {
        const list = el("div", { style:"display:flex; flex-direction:column; gap:10px; overflow:hidden;" });

        photos.slice(0, 3).forEach(ph => {
          const row = el("div", { style:"display:flex; gap:10px; align-items:center;" });

          // CLICK pe pozƒÉ => deschide imaginea (image_url)
          const imgLink = el("a", {
            href: ph.image_url,
            target: "_blank",
            rel: "noopener noreferrer",
            style: "display:block; flex:0 0 auto;"
          });

          const img = el("img", {
            src: ph.image_url,
            alt: ph.title || "Photo",
            style: "width:90px;height:60px;object-fit:cover;border-radius:10px;border:1px solid #eee;cursor:pointer;"
          });
          imgLink.appendChild(img);

          const right = el("div", { style:"min-width:0; flex:1 1 auto;" });

          const badge = el("div", {
            style:"display:inline-block;font-size:11px;color:#666;border:1px solid #eee;padding:2px 8px;border-radius:999px;margin-bottom:4px;background:#fafafa;"
          }, ph.category_label || "Foto");

          // CLICK pe titlu => deschide pagina articolului (link)
          const t = el("a", {
            href: ph.link,
            target: "_blank",
            rel: "noopener noreferrer",
            style: "display:block; color:#111; text-decoration:none; font-size:14px; line-height:1.25; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"
          }, ph.title || "Deschide");

          t.onmouseover = () => t.style.textDecoration = "underline";
          t.onmouseout = () => t.style.textDecoration = "none";

          const s = el("div", { style:"font-size:12px;color:#777; margin-top:3px;" }, ph.source || "");

          right.appendChild(badge);
          right.appendChild(t);
          right.appendChild(s);

          row.appendChild(imgLink);
          row.appendChild(right);
          list.appendChild(row);
        });

        photoCard.appendChild(list);
        photoCard.appendChild(el("div", { style:"margin-top:auto; font-size:12px;color:#999;" }, "Click pe pozƒÉ = imagine mare"));
      } else {
        photoCard.appendChild(el("div", { style:"font-size:16px;color:#111;line-height:1.5" }, "√én cur√¢nd üôÇ"));
        photoCard.appendChild(el("div", { style:"margin-top:auto; font-size:12px;color:#999;" }, " "));
      }

      // üòÑ Joke
      const joke = (sections.joke && sections.joke[0]) ? sections.joke[0] : null;
      const jokeCard = el("div", { style: cardBase(`height:${FIXED_H}; overflow:hidden; display:flex; flex-direction:column;`) });
      jokeCard.appendChild(el("div", { style:"font-size:13px;color:#666;margin-bottom:10px" }, "üòÑ Bancul zilei"));

      const jokeText = (joke && joke.text) ? joke.text : "√én cur√¢nd üôÇ";
      jokeCard.appendChild(el("div", { style:"font-size:16px;color:#111;line-height:1.5" }, jokeText));
      jokeCard.appendChild(el("div", { style:"margin-top:auto; font-size:12px;color:#999;" }, " "));

      // üòà Satire
      const satire = (sections.satire && sections.satire[0]) ? sections.satire[0] : null;
      const satCard = el("div", { style: cardBase(`height:${FIXED_H}; overflow:hidden; display:flex; flex-direction:column;`) });
      satCard.appendChild(el("div", { style:"font-size:13px;color:#666;margin-bottom:10px" }, "üòà SatirƒÉ (TimesNewRoman)"));

      if (satire && satire.link) {
        const sa = el("a", {
          href: satire.link,
          target: "_blank",
          rel: "noopener noreferrer",
          style: "color:#111;text-decoration:none;font-size:16px;line-height:1.35; display:block;"
        }, satire.title || "Cite»ôte");

        sa.onmouseover = () => sa.style.textDecoration = "underline";
        sa.onmouseout = () => sa.style.textDecoration = "none";

        satCard.appendChild(sa);
        if (satire.summary) {
          satCard.appendChild(el("div", {style:"font-size:13px;color:#333;margin-top:8px;line-height:1.45;max-height:70px;overflow:hidden;"}, satire.summary));
        }

        satCard.appendChild(el("div", { style:"font-size:12px;color:#777;margin-top:8px" }, "SatirƒÉ ‚Äî nu este »ôtire realƒÉ."));
      } else {
        satCard.appendChild(el("div", { style:"font-size:16px;color:#111;line-height:1.5" }, "√én cur√¢nd üôÇ"));
      }
      satCard.appendChild(el("div", { style:"margin-top:auto; font-size:12px;color:#999;" }, " "));

      host.appendChild(photoCard);
      host.appendChild(jokeCard);
      host.appendChild(satCard);
    }

    function renderSections(sections) {
      const container = document.getElementById("sections");
      container.innerHTML = "";

      const order = ["romania", "medical", "science", "environment"];

      for (const secId of order) {
        const arr = Array.isArray(sections[secId]) ? sections[secId] : [];
        if (!arr.length) continue;

        const header = el("h2", { style:"margin:26px 0 10px;font-size:22px" }, SECTION_TITLES[secId] || secId);
        container.appendChild(header);

        arr.forEach(it => container.appendChild(renderNewsItem(it)));
      }
    }

    async function load() {
      const res = await fetch(`./data/news.json?t=${Date.now()}`, { cache: "no-store" });
      const data = await res.json();

      const meta = document.getElementById("meta");
      const generated = new Date(data.generated_utc);
      meta.textContent = `Ultima actualizare: ${generated.toLocaleString("ro-RO")}`;

      const sections = data.sections || {};
      renderTopBlocks(sections);
      renderSections(sections);
    }

    load().catch(err => {
      document.getElementById("sections").innerHTML = `
        <div style="${cardBase()} margin:12px 0;">
          <h2 style="margin:0 0 8px;">Eroare la √ÆncƒÉrcare</h2>
          <p style="margin:0;color:#333">${String(err)}</p>
        </div>
      `;
    });
  </script>

</body>
</html>
